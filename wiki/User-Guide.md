# 用户指南

本指南详细介绍 ProtoTool 的各项功能和使用方法。

## 目录

- [界面概览](#界面概览)
- [连接管理](#连接管理)
- [会话管理](#会话管理)
- [数据收发](#数据收发)
- [协议解析](#协议解析)
- [数据存储](#数据存储)
- [工具箱](#工具箱)
- [配置选项](#配置选项)

## 界面概览

ProtoTool 的主界面分为以下几个区域：

### 左侧导航栏

- **工作区**: 连接和会话管理
- **协议仓库**: 协议管理和协议商店
- **工具箱**: 内置工具集合
- **数据存储**: 数据库连接和存储管理
- **设置**: 应用配置

### 主工作区

- **连接列表**: 显示所有连接
- **会话详情**: 当前会话的详细信息
- **数据显示区**: 接收和发送的数据
- **解析结果**: 协议解析后的结构化数据

### 底部面板

- **发送区域**: 输入要发送的数据
- **状态栏**: 显示连接状态和统计信息

## 连接管理

详见 [[Connection Management|Connection-Management]]。

### 支持的协议类型

#### TCP 连接

**TCP 客户端**：
- 连接到远程 TCP 服务器
- 支持自动重连
- 支持 Keep-Alive

**TCP 服务器**：
- 监听指定端口
- 支持多客户端连接
- 每个客户端独立会话

#### UDP 连接

**UDP 客户端**：
- 发送 UDP 数据包
- 接收 UDP 响应

**UDP 服务器**：
- 监听 UDP 端口
- 支持广播和组播

#### WebSocket 连接

- 支持 ws:// 和 wss:// 协议
- 支持自定义请求头
- 支持子协议协商
- 自动处理心跳

#### MQTT 连接

- 完整的 MQTT 3.1.1 和 5.0 支持
- 主题订阅和发布
- QoS 0/1/2 支持
- 遗嘱消息
- 保留消息

#### SSE 连接

- 服务器推送事件
- 自动重连
- 事件类型过滤

### 连接配置

每种连接类型都有特定的配置选项：

**通用配置**：
- 连接名称
- 自动重连
- 重连间隔
- 超时设置

**TCP 特定配置**：
- Keep-Alive 间隔
- No-Delay 选项
- 缓冲区大小

**WebSocket 特定配置**：
- 请求头
- 子协议
- 压缩选项

**MQTT 特定配置**：
- Client ID
- Clean Session
- Keep Alive
- 用户名/密码
- TLS/SSL 配置

## 会话管理

详见 [[Session Management|Session-Management]]。

### 会话生命周期

1. **创建**: 建立连接时自动创建会话
2. **活动**: 会话处于活动状态，可收发数据
3. **暂停**: 暂停数据接收，但保持连接
4. **关闭**: 断开连接，结束会话

### 会话操作

**基本操作**：
- 暂停/继续接收
- 清空数据
- 导出数据
- 关闭会话

**高级操作**：
- 会话录制
- 会话回放
- 会话克隆
- 会话比较

### 会话信息

每个会话显示以下信息：
- 连接状态
- 已接收字节数
- 已发送字节数
- 消息计数
- 错误计数
- 活动时间

## 数据收发

### 发送数据

**数据格式**：
- **文本**: 普通文本，支持转义字符
- **十六进制**: 十六进制字节序列（如 `01 02 03 FF`）
- **Base64**: Base64 编码的数据
- **JSON**: JSON 格式数据（自动格式化）

**发送选项**：
- **单次发送**: 发送一次
- **循环发送**: 按指定间隔重复发送
- **批量发送**: 从文件读取多条数据发送

**快捷操作**：
- `Ctrl+Enter` / `Cmd+Enter`: 快速发送
- `↑` / `↓`: 浏览发送历史
- `Ctrl+L`: 清空输入区

### 接收数据

**显示格式**：
- 文本
- 十六进制
- 混合显示（文本+十六进制）
- JSON 格式化

**显示选项**：
- 自动滚动
- 时间戳显示
- 方向标识（发送/接收）
- 字节偏移

**数据过滤**：
- 按内容过滤
- 按方向过滤
- 按时间范围过滤
- 正则表达式过滤

### 数据操作

- **复制**: 复制选中的数据
- **导出**: 导出为文件（TXT/CSV/JSON）
- **搜索**: 在数据中搜索
- **高亮**: 高亮显示特定内容

## 协议解析

详见 [[Protocol System|Protocol-System]]。

### 应用协议

1. 在会话中点击"选择协议"
2. 从列表中选择已安装的协议
3. 协议自动应用到新接收的数据

### 查看解析结果

解析结果以树形结构显示：
- **字段名**: 字段的名称
- **值**: 解析后的值
- **类型**: 数据类型
- **偏移**: 在原始数据中的位置
- **长度**: 字段占用的字节数

### 解析选项

- **自动解析**: 接收数据时自动解析
- **手动解析**: 手动触发解析
- **容错模式**: 解析失败时的处理方式
- **显示原始数据**: 同时显示原始和解析后的数据

## 数据存储

详见 [[Data Storage|Data-Storage]]。

### 存储方式

**热存储（SQLite）**：
- 实时数据存储
- 快速查询
- 适合短期数据

**冷存储（Parquet）**：
- 归档数据存储
- 高压缩比
- 适合长期存储

### 数据库连接

支持连接到外部数据库：
- MySQL 5.x/8.x
- InfluxDB v1
- Redis
- TimescaleDB
- MinIO

### 数据查询

支持 KQL 风格的查询语言：

```kql
sessions
| where protocol == "TCP"
| where timestamp > ago(1h)
| summarize count() by status
```

## 工具箱

详见 [[Toolbox]]。

### 内置工具

**报文生成器**：
- 生成测试报文
- 支持模板
- 批量生成

**协议解析器**：
- 手动解析数据
- 测试协议规则
- 调试协议

**数据转换器**：
- 格式转换
- 编码转换
- 进制转换

**CRC 计算器**：
- CRC8/16/32
- 自定义多项式
- 批量计算

**时间戳转换器**：
- Unix 时间戳转换
- 多时区支持
- 批量转换

### 使用工具

1. 点击左侧导航栏的"工具箱"
2. 选择需要的工具
3. 输入数据或配置参数
4. 点击"执行"或"转换"按钮
5. 查看结果

## 配置选项

### 应用设置

**常规设置**：
- 语言选择
- 主题（亮色/暗色）
- 启动时行为

**性能设置**：
- 接收缓冲区大小
- 最大显示行数
- 自动清理阈值

**网络设置**：
- 默认超时时间
- 重连策略
- 代理配置

**存储设置**：
- 数据保留时间
- 自动归档
- 存储位置

### 快捷键

| 操作 | Windows/Linux | macOS |
|------|---------------|-------|
| 发送数据 | `Ctrl+Enter` | `Cmd+Enter` |
| 清空输入 | `Ctrl+L` | `Cmd+L` |
| 新建连接 | `Ctrl+N` | `Cmd+N` |
| 关闭会话 | `Ctrl+W` | `Cmd+W` |
| 搜索 | `Ctrl+F` | `Cmd+F` |
| 设置 | `Ctrl+,` | `Cmd+,` |

## 最佳实践

### 性能优化

1. **限制显示行数**: 大量数据时限制显示行数
2. **使用过滤器**: 只显示需要的数据
3. **定期清理**: 定期清理旧数据
4. **关闭自动滚动**: 高频数据时关闭自动滚动

### 数据管理

1. **及时导出**: 重要数据及时导出
2. **使用标签**: 为会话添加标签便于管理
3. **定期备份**: 定期备份配置和数据
4. **使用模板**: 创建连接模板快速创建连接

### 调试技巧

1. **使用十六进制**: 调试二进制协议时使用十六进制显示
2. **对比数据**: 使用会话比较功能对比不同会话
3. **录制回放**: 录制问题场景用于复现
4. **查看原始数据**: 解析失败时查看原始数据

## 相关页面

- [[Connection Management|Connection-Management]] - 连接管理详解
- [[Session Management|Session-Management]] - 会话管理详解
- [[Protocol System|Protocol-System]] - 协议系统详解
- [[Data Storage|Data-Storage]] - 数据存储详解
- [[Toolbox]] - 工具箱详解

---

**上一页**: [[Getting Started|Getting-Started]] | **下一页**: [[Protocol System|Protocol-System]]

